{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\app\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"filename\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\app\\\\app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.6:development":{"value":{"code":"const express = require('express');\nconst db = require('../db/db');\nconst imageRoutes = require('../routers/imageRouter');\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// Kết nối đến cơ sở dữ liệu PostgreSQL\ndb.connect();\n\n// Middleware để xử lý các request có nội dung JSON\napp.use(express.json());\n\n// Sử dụng định tuyến cho ảnh\napp.use('/api/images', imageRoutes);\n\n// Khởi động server\napp.listen(port, () => {\n  console.log(`Server is running on port http://localhost:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImRiIiwiaW1hZ2VSb3V0ZXMiLCJhcHAiLCJwb3J0IiwicHJvY2VzcyIsImVudiIsIlBPUlQiLCJjb25uZWN0IiwidXNlIiwianNvbiIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IkQ6XFxQSEFNSFVOR1xcY29kZS1kZW1vXFxjb3ZlckltYWdlXFxhcHBcXCIsInNvdXJjZXMiOlsiYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IGRiID0gcmVxdWlyZSgnLi4vZGIvZGInKVxyXG5jb25zdCBpbWFnZVJvdXRlcyA9IHJlcXVpcmUoJy4uL3JvdXRlcnMvaW1hZ2VSb3V0ZXInKTtcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcclxuXHJcbi8vIEvhur90IG7hu5FpIMSR4bq/biBjxqEgc+G7nyBk4buvIGxp4buHdSBQb3N0Z3JlU1FMXHJcbmRiLmNvbm5lY3QoKTtcclxuXHJcbi8vIE1pZGRsZXdhcmUgxJHhu4MgeOG7rSBsw70gY8OhYyByZXF1ZXN0IGPDsyBu4buZaSBkdW5nIEpTT05cclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcblxyXG4vLyBT4butIGThu6VuZyDEkeG7i25oIHR1eeG6v24gY2hvIOG6o25oXHJcbmFwcC51c2UoJy9hcGkvaW1hZ2VzJywgaW1hZ2VSb3V0ZXMpO1xyXG5cclxuLy8gS2jhu59pIMSR4buZbmcgc2VydmVyXHJcbmFwcC5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGBTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0IGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fWApO1xyXG59KTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsRUFBRSxHQUFHRCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQzlCLE1BQU1FLFdBQVcsR0FBR0YsT0FBTyxDQUFDLHdCQUF3QixDQUFDO0FBRXJELE1BQU1HLEdBQUcsR0FBR0osT0FBTyxDQUFDLENBQUM7QUFDckIsTUFBTUssSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsSUFBSSxJQUFJLElBQUk7O0FBRXJDO0FBQ0FOLEVBQUUsQ0FBQ08sT0FBTyxDQUFDLENBQUM7O0FBRVo7QUFDQUwsR0FBRyxDQUFDTSxHQUFHLENBQUNWLE9BQU8sQ0FBQ1csSUFBSSxDQUFDLENBQUMsQ0FBQzs7QUFFdkI7QUFDQVAsR0FBRyxDQUFDTSxHQUFHLENBQUMsYUFBYSxFQUFFUCxXQUFXLENBQUM7O0FBRW5DO0FBQ0FDLEdBQUcsQ0FBQ1EsTUFBTSxDQUFDUCxJQUFJLEVBQUUsTUFBTTtFQUNyQlEsT0FBTyxDQUFDQyxHQUFHLENBQUUsOENBQTZDVCxJQUFLLEVBQUMsQ0FBQztBQUNuRSxDQUFDLENBQUMifQ==","map":{"version":3,"names":["express","require","db","imageRoutes","app","port","process","env","PORT","connect","use","json","listen","console","log"],"sourceRoot":"D:\\PHAMHUNG\\code-demo\\coverImage\\app\\","sources":["app.js"],"sourcesContent":["const express = require('express');\r\nconst db = require('../db/db')\r\nconst imageRoutes = require('../routers/imageRouter');\r\n\r\nconst app = express();\r\nconst port = process.env.PORT || 3000;\r\n\r\n// Kết nối đến cơ sở dữ liệu PostgreSQL\r\ndb.connect();\r\n\r\n// Middleware để xử lý các request có nội dung JSON\r\napp.use(express.json());\r\n\r\n// Sử dụng định tuyến cho ảnh\r\napp.use('/api/images', imageRoutes);\r\n\r\n// Khởi động server\r\napp.listen(port, () => {\r\n  console.log(`Server is running on port http://localhost:${port}`);\r\n});\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,EAAE,GAAGD,OAAO,CAAC,UAAU,CAAC;AAC9B,MAAME,WAAW,GAAGF,OAAO,CAAC,wBAAwB,CAAC;AAErD,MAAMG,GAAG,GAAGJ,OAAO,CAAC,CAAC;AACrB,MAAMK,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI,IAAI,IAAI;;AAErC;AACAN,EAAE,CAACO,OAAO,CAAC,CAAC;;AAEZ;AACAL,GAAG,CAACM,GAAG,CAACV,OAAO,CAACW,IAAI,CAAC,CAAC,CAAC;;AAEvB;AACAP,GAAG,CAACM,GAAG,CAAC,aAAa,EAAEP,WAAW,CAAC;;AAEnC;AACAC,GAAG,CAACQ,MAAM,CAACP,IAAI,EAAE,MAAM;EACrBQ,OAAO,CAACC,GAAG,CAAE,8CAA6CT,IAAK,EAAC,CAAC;AACnE,CAAC,CAAC"}},"mtime":1703834756747},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\db\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"filename\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\db\\\\db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.6:development":{"value":{"code":"const {\n  Pool\n} = require('pg');\nconst pool = new Pool({\n  user: 'converimagedb_user',\n  host: 'dpg-cm73mlocmk4c738rih20-a.singapore-postgres.render.com',\n  database: 'converimagedb',\n  password: 'HP4EWDBbcQPh6NaGzvH5oxe3PvHGfFnd',\n  port: 5432,\n  ssl: {\n    rejectUnauthorized: false // Bạn có thể cần cấu hình phù hợp với môi trường sản xuất\n  }\n});\nmodule.exports = pool;\n// postgres://converimagedb_user:HP4EWDBbcQPh6NaGzvH5oxe3PvHGfFnd@dpg-cm73mlocmk4c738rih20-a/converimagedb\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQb29sIiwicmVxdWlyZSIsInBvb2wiLCJ1c2VyIiwiaG9zdCIsImRhdGFiYXNlIiwicGFzc3dvcmQiLCJwb3J0Iiwic3NsIiwicmVqZWN0VW5hdXRob3JpemVkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRDpcXFBIQU1IVU5HXFxjb2RlLWRlbW9cXGNvdmVySW1hZ2VcXGRiXFwiLCJzb3VyY2VzIjpbImRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgUG9vbCB9ID0gcmVxdWlyZSgncGcnKTtcclxuXHJcbmNvbnN0IHBvb2wgPSBuZXcgUG9vbCh7XHJcbiAgdXNlcjogJ2NvbnZlcmltYWdlZGJfdXNlcicsXHJcbiAgaG9zdDogJ2RwZy1jbTczbWxvY21rNGM3MzhyaWgyMC1hLnNpbmdhcG9yZS1wb3N0Z3Jlcy5yZW5kZXIuY29tJyxcclxuICBkYXRhYmFzZTogJ2NvbnZlcmltYWdlZGInLFxyXG4gIHBhc3N3b3JkOiAnSFA0RVdEQmJjUVBoNk5hR3p2SDVveGUzUHZIR2ZGbmQnLFxyXG4gIHBvcnQ6IDU0MzIsXHJcbiAgc3NsOiB7XHJcbiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlLCAvLyBC4bqhbiBjw7MgdGjhu4MgY+G6p24gY+G6pXUgaMOsbmggcGjDuSBo4bujcCB24bubaSBtw7RpIHRyxrDhu51uZyBz4bqjbiB4deG6pXRcclxuICB9LFxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcG9vbDtcclxuLy8gcG9zdGdyZXM6Ly9jb252ZXJpbWFnZWRiX3VzZXI6SFA0RVdEQmJjUVBoNk5hR3p2SDVveGUzUHZIR2ZGbmRAZHBnLWNtNzNtbG9jbWs0YzczOHJpaDIwLWEvY29udmVyaW1hZ2VkYiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUFFQTtBQUFLLENBQUMsR0FBR0MsT0FBTyxDQUFDLElBQUksQ0FBQztBQUU5QixNQUFNQyxJQUFJLEdBQUcsSUFBSUYsSUFBSSxDQUFDO0VBQ3BCRyxJQUFJLEVBQUUsb0JBQW9CO0VBQzFCQyxJQUFJLEVBQUUsMERBQTBEO0VBQ2hFQyxRQUFRLEVBQUUsZUFBZTtFQUN6QkMsUUFBUSxFQUFFLGtDQUFrQztFQUM1Q0MsSUFBSSxFQUFFLElBQUk7RUFDVkMsR0FBRyxFQUFFO0lBQ0hDLGtCQUFrQixFQUFFLEtBQUssQ0FBRTtFQUM3QjtBQUNGLENBQUMsQ0FBQztBQUVGQyxNQUFNLENBQUNDLE9BQU8sR0FBR1QsSUFBSTtBQUNyQiJ9","map":{"version":3,"names":["Pool","require","pool","user","host","database","password","port","ssl","rejectUnauthorized","module","exports"],"sourceRoot":"D:\\PHAMHUNG\\code-demo\\coverImage\\db\\","sources":["db.js"],"sourcesContent":["const { Pool } = require('pg');\r\n\r\nconst pool = new Pool({\r\n  user: 'converimagedb_user',\r\n  host: 'dpg-cm73mlocmk4c738rih20-a.singapore-postgres.render.com',\r\n  database: 'converimagedb',\r\n  password: 'HP4EWDBbcQPh6NaGzvH5oxe3PvHGfFnd',\r\n  port: 5432,\r\n  ssl: {\r\n    rejectUnauthorized: false, // Bạn có thể cần cấu hình phù hợp với môi trường sản xuất\r\n  },\r\n});\r\n\r\nmodule.exports = pool;\r\n// postgres://converimagedb_user:HP4EWDBbcQPh6NaGzvH5oxe3PvHGfFnd@dpg-cm73mlocmk4c738rih20-a/converimagedb"],"mappings":"AAAA,MAAM;EAAEA;AAAK,CAAC,GAAGC,OAAO,CAAC,IAAI,CAAC;AAE9B,MAAMC,IAAI,GAAG,IAAIF,IAAI,CAAC;EACpBG,IAAI,EAAE,oBAAoB;EAC1BC,IAAI,EAAE,0DAA0D;EAChEC,QAAQ,EAAE,eAAe;EACzBC,QAAQ,EAAE,kCAAkC;EAC5CC,IAAI,EAAE,IAAI;EACVC,GAAG,EAAE;IACHC,kBAAkB,EAAE,KAAK,CAAE;EAC7B;AACF,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGT,IAAI;AACrB"}},"mtime":1703821029671},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\routers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"filename\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\routers\\\\imageRouter.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.6:development":{"value":{"code":"const express = require('express');\nconst imageController = require('../controllers/imageController');\nconst router = express.Router();\nrouter.post('/convert-and-save', async (req, res) => {\n  try {\n    const {\n      outputImagePath,\n      outputPath,\n      customFileName\n    } = req.body;\n    await imageController.convertAndSaveToDB(outputImagePath, outputPath, customFileName);\n    res.status(200).json({\n      message: 'Conversion and saving completed successfully'\n    });\n  } catch (error) {\n    console.error('Error:', error);\n    res.status(500).json({\n      error: 'Internal Server Error'\n    });\n  }\n});\n\n// router.post('/convert', async (req, res) => {\n//     const { outputImagePath, partWidth, partHeight } = req.body;\n\n//     // Kiểm tra dữ liệu đầu vào\n//     if (!outputImagePath || !partWidth || !partHeight) {\n//         return res.status(400).json({ error: 'Missing required parameters.' });\n//     }\n\n//     try {\n//         // Gọi hàm chuyển đổi từ imageController\n//        const data =  await imageController.textToImage(outputImagePath, partWidth, partHeight);\n//         res.json({ message: 'Conversion completed successfully.', data: data });\n//     } catch (error) {\n//         console.error('Error:', error);\n//         res.status(500).json({ error: 'Internal server error.' });\n//     }\n// });\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImltYWdlQ29udHJvbGxlciIsInJvdXRlciIsIlJvdXRlciIsInBvc3QiLCJyZXEiLCJyZXMiLCJvdXRwdXRJbWFnZVBhdGgiLCJvdXRwdXRQYXRoIiwiY3VzdG9tRmlsZU5hbWUiLCJib2R5IiwiY29udmVydEFuZFNhdmVUb0RCIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJlcnJvciIsImNvbnNvbGUiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJEOlxcUEhBTUhVTkdcXGNvZGUtZGVtb1xcY292ZXJJbWFnZVxccm91dGVyc1xcIiwic291cmNlcyI6WyJpbWFnZVJvdXRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCBpbWFnZUNvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9pbWFnZUNvbnRyb2xsZXInKTtcclxuXHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG5yb3V0ZXIucG9zdCgnL2NvbnZlcnQtYW5kLXNhdmUnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBvdXRwdXRJbWFnZVBhdGgsIG91dHB1dFBhdGgsIGN1c3RvbUZpbGVOYW1lIH0gPSByZXEuYm9keTtcclxuICAgIGF3YWl0IGltYWdlQ29udHJvbGxlci5jb252ZXJ0QW5kU2F2ZVRvREIob3V0cHV0SW1hZ2VQYXRoLCBvdXRwdXRQYXRoLCBjdXN0b21GaWxlTmFtZSk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdDb252ZXJzaW9uIGFuZCBzYXZpbmcgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0pO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyByb3V0ZXIucG9zdCgnL2NvbnZlcnQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuLy8gICAgIGNvbnN0IHsgb3V0cHV0SW1hZ2VQYXRoLCBwYXJ0V2lkdGgsIHBhcnRIZWlnaHQgfSA9IHJlcS5ib2R5O1xyXG5cclxuLy8gICAgIC8vIEtp4buDbSB0cmEgZOG7ryBsaeG7h3UgxJHhuqd1IHbDoG9cclxuLy8gICAgIGlmICghb3V0cHV0SW1hZ2VQYXRoIHx8ICFwYXJ0V2lkdGggfHwgIXBhcnRIZWlnaHQpIHtcclxuLy8gICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ01pc3NpbmcgcmVxdWlyZWQgcGFyYW1ldGVycy4nIH0pO1xyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIHRyeSB7XHJcbi8vICAgICAgICAgLy8gR+G7jWkgaMOgbSBjaHV54buDbiDEkeG7lWkgdOG7qyBpbWFnZUNvbnRyb2xsZXJcclxuLy8gICAgICAgIGNvbnN0IGRhdGEgPSAgYXdhaXQgaW1hZ2VDb250cm9sbGVyLnRleHRUb0ltYWdlKG91dHB1dEltYWdlUGF0aCwgcGFydFdpZHRoLCBwYXJ0SGVpZ2h0KTtcclxuLy8gICAgICAgICByZXMuanNvbih7IG1lc3NhZ2U6ICdDb252ZXJzaW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgZGF0YTogZGF0YSB9KTtcclxuLy8gICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbi8vICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyb3IpO1xyXG4vLyAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuJyB9KTtcclxuLy8gICAgIH1cclxuLy8gfSk7XHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsZUFBZSxHQUFHRCxPQUFPLENBQUMsZ0NBQWdDLENBQUM7QUFFakUsTUFBTUUsTUFBTSxHQUFHSCxPQUFPLENBQUNJLE1BQU0sQ0FBQyxDQUFDO0FBRS9CRCxNQUFNLENBQUNFLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUNuRCxJQUFJO0lBQ0YsTUFBTTtNQUFFQyxlQUFlO01BQUVDLFVBQVU7TUFBRUM7SUFBZSxDQUFDLEdBQUdKLEdBQUcsQ0FBQ0ssSUFBSTtJQUNoRSxNQUFNVCxlQUFlLENBQUNVLGtCQUFrQixDQUFDSixlQUFlLEVBQUVDLFVBQVUsRUFBRUMsY0FBYyxDQUFDO0lBQ3JGSCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQUVDLE9BQU8sRUFBRTtJQUErQyxDQUFDLENBQUM7RUFDbkYsQ0FBQyxDQUFDLE9BQU9DLEtBQUssRUFBRTtJQUNkQyxPQUFPLENBQUNELEtBQUssQ0FBQyxRQUFRLEVBQUVBLEtBQUssQ0FBQztJQUM5QlQsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUFFRSxLQUFLLEVBQUU7SUFBd0IsQ0FBQyxDQUFDO0VBQzFEO0FBQ0YsQ0FBQyxDQUFDOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBRSxNQUFNLENBQUNDLE9BQU8sR0FBR2hCLE1BQU0ifQ==","map":{"version":3,"names":["express","require","imageController","router","Router","post","req","res","outputImagePath","outputPath","customFileName","body","convertAndSaveToDB","status","json","message","error","console","module","exports"],"sourceRoot":"D:\\PHAMHUNG\\code-demo\\coverImage\\routers\\","sources":["imageRouter.js"],"sourcesContent":["const express = require('express');\r\nconst imageController = require('../controllers/imageController');\r\n\r\nconst router = express.Router();\r\n\r\nrouter.post('/convert-and-save', async (req, res) => {\r\n  try {\r\n    const { outputImagePath, outputPath, customFileName } = req.body;\r\n    await imageController.convertAndSaveToDB(outputImagePath, outputPath, customFileName);\r\n    res.status(200).json({ message: 'Conversion and saving completed successfully' });\r\n  } catch (error) {\r\n    console.error('Error:', error);\r\n    res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n});\r\n\r\n// router.post('/convert', async (req, res) => {\r\n//     const { outputImagePath, partWidth, partHeight } = req.body;\r\n\r\n//     // Kiểm tra dữ liệu đầu vào\r\n//     if (!outputImagePath || !partWidth || !partHeight) {\r\n//         return res.status(400).json({ error: 'Missing required parameters.' });\r\n//     }\r\n\r\n//     try {\r\n//         // Gọi hàm chuyển đổi từ imageController\r\n//        const data =  await imageController.textToImage(outputImagePath, partWidth, partHeight);\r\n//         res.json({ message: 'Conversion completed successfully.', data: data });\r\n//     } catch (error) {\r\n//         console.error('Error:', error);\r\n//         res.status(500).json({ error: 'Internal server error.' });\r\n//     }\r\n// });\r\n\r\n\r\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,eAAe,GAAGD,OAAO,CAAC,gCAAgC,CAAC;AAEjE,MAAME,MAAM,GAAGH,OAAO,CAACI,MAAM,CAAC,CAAC;AAE/BD,MAAM,CAACE,IAAI,CAAC,mBAAmB,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACnD,IAAI;IACF,MAAM;MAAEC,eAAe;MAAEC,UAAU;MAAEC;IAAe,CAAC,GAAGJ,GAAG,CAACK,IAAI;IAChE,MAAMT,eAAe,CAACU,kBAAkB,CAACJ,eAAe,EAAEC,UAAU,EAAEC,cAAc,CAAC;IACrFH,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA+C,CAAC,CAAC;EACnF,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAAC;IAC9BT,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEE,KAAK,EAAE;IAAwB,CAAC,CAAC;EAC1D;AACF,CAAC,CAAC;;AAEF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGAE,MAAM,CAACC,OAAO,GAAGhB,MAAM"}},"mtime":1703838586814},"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"filename\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\\\\controllers\\\\imageController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\PHAMHUNG\\\\code-demo\\\\coverImage\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.6:development":{"value":{"code":"const fs = require('fs');\nconst sharp = require('sharp');\nconst db = require('../db/db');\nasync function imageToText(inputImagePath, outputFolder, customFileName) {\n  // ... (phần code chuyển đổi từ trước)\n  // Kích thước của từng phần nhỏ\n  // const partWidth = 4816;\n  // const partHeight = 3072;\n  // const partWidth = 2600;\n  // const partHeight = 3184;\n  // const partWidth = 5760;\n  // const partHeight = 3336;\n  // const partWidth = 4242;\n  // const partHeight = 2456;\n  // const partWidth = 5372;\n  // const partHeight = 2824;\n  const partWidth = 8192;\n  const partHeight = 4096;\n  // Zoom factor\n  const zoom = 1.0;\n  // Đọc ảnh và chuyển đổi thành các phần nhỏ\n  const imageBuffer = fs.readFileSync(inputImagePath);\n  const image = sharp(imageBuffer);\n\n  // Tạo thư mục đầu ra nếu chưa tồn tại\n  if (!fs.existsSync(outputFolder)) {\n    fs.mkdirSync(outputFolder);\n  }\n  // Chuyển đổi và ghi vào các file văn bản\n  const imageMetadata = await image.metadata();\n  console.log('Image Metadata:', imageMetadata);\n  const resizedWidth = imageMetadata.width * zoom;\n  const resizedHeight = imageMetadata.height * zoom;\n  for (let top = 0; top < imageMetadata.height; top += partHeight) {\n    console.log('Vào vòng lặp top');\n    for (let left = 0; left < imageMetadata.width; left += partWidth) {\n      console.log('Vào vòng lặp left');\n      const adjustedWidth = Math.min(partWidth, imageMetadata.width - left);\n      const adjustedHeight = Math.min(partHeight, imageMetadata.height - top);\n      const adjustedLeft = Math.max(0, left);\n      const adjustedTop = Math.max(0, top);\n      const leftPercentage = adjustedLeft / imageMetadata.width;\n      const topPercentage = adjustedTop / imageMetadata.height;\n      const resizedBuffer = await image.jpeg().resize(resizedWidth, resizedHeight).toBuffer();\n      const extractedBuffer = await sharp(resizedBuffer).extract({\n        left: Math.floor(leftPercentage * resizedWidth),\n        top: Math.floor(topPercentage * resizedHeight),\n        width: adjustedWidth,\n        height: adjustedHeight\n      }).resize(adjustedWidth, adjustedHeight).toBuffer();\n      const base64String = 'data:image/jpeg;base64,' + Buffer.from(extractedBuffer).toString('base64');\n      for (let partIndex = 0; partIndex < 10; partIndex++) {\n        const partBase64String = base64String.substring(partIndex * (base64String.length / 10), (partIndex + 1) * (base64String.length / 10));\n        const partFileName = `${outputFolder}/${customFileName}_part${partIndex + 1}.txt`;\n        fs.writeFileSync(partFileName, partBase64String);\n        console.log('Đã ghi file:', partFileName);\n      }\n    }\n  }\n  console.log('Image to text conversion completed.');\n}\nasync function convertAndSaveToDB(inputImagePath, outputFolder, customFileName) {\n  try {\n    await imageToText(inputImagePath, outputFolder, customFileName);\n\n    // const files = fs.readdirSync(outputFolder);\n\n    // for (const file of files) {\n    //     const content = fs.readFileSync(`${outputFolder}/${file}`, 'base64');\n    //     await db.query('INSERT INTO images(name, content) VALUES($1, $2)', [file, content]);\n    // }\n    console.log('Conversion and saving completed successfully');\n  } catch (error) {\n    console.error('Error:', error);\n    throw new Error('Conversion and saving failed');\n  }\n}\n\n// async function textToImage(outputImagePath, partWidth, partHeight) {\n//     try {\n//         // Thực hiện truy vấn cơ sở dữ liệu để lấy dữ liệu từ bảng 'images'\n//         const result = await db.query('SELECT name, content FROM images');\n\n//         if (result.rows.length === 0) {\n//             console.error('No data found in the images table.');\n//             return;\n//         }\n\n//         // Chuyển đổi từng bản ghi từ cơ sở dữ liệu thành ảnh và lưu vào mảng\n//         const images = await Promise.all(result.rows.map(async (row) => {\n//             const base64Data = row.content.replace(/\\\\/g, \"\");\n//             const buffer = Buffer.from(base64Data, 'base64');\n//             console.log(base64Data);\n//             return buffer;\n//         }));\n\n//         const firstImageMetadata = await sharp(images[0]).metadata();\n\n//         // Gộp ảnh\n//         const mergedImage = await sharp({\n//             create: {\n//                 width: partWidth * Math.ceil(firstImageMetadata.width / partWidth),\n//                 height: partHeight * Math.ceil(firstImageMetadata.height / partHeight),\n//                 channels: 4, // Số kênh màu (4 cho RGBA)\n//                 background: { r: 255, g: 255, b: 255, alpha: 1 } // Màu nền\n//             }\n//         });\n\n//         // Sử dụng phương thức composite để gộp ảnh\n//         for (const image of images) {\n//             mergedImage.composite([{ input: image, left: 0, top: 0 }]);\n//         }\n\n//         // Ghi ảnh gộp vào file với định dạng PNG\n//         await mergedImage.toFormat('png').toFile(outputImagePath);\n//         console.log('Text to image conversion completed.');\n\n//         // Trả về đường dẫn tới tệp tin ảnh đã tạo\n//         return outputImagePath;\n//     } catch (error) {\n//         console.error('Error during conversion:', error);\n//         throw error;\n//     }\n// }\n\nmodule.exports = {\n  convertAndSaveToDB\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJzaGFycCIsImRiIiwiaW1hZ2VUb1RleHQiLCJpbnB1dEltYWdlUGF0aCIsIm91dHB1dEZvbGRlciIsImN1c3RvbUZpbGVOYW1lIiwicGFydFdpZHRoIiwicGFydEhlaWdodCIsInpvb20iLCJpbWFnZUJ1ZmZlciIsInJlYWRGaWxlU3luYyIsImltYWdlIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsImltYWdlTWV0YWRhdGEiLCJtZXRhZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJyZXNpemVkV2lkdGgiLCJ3aWR0aCIsInJlc2l6ZWRIZWlnaHQiLCJoZWlnaHQiLCJ0b3AiLCJsZWZ0IiwiYWRqdXN0ZWRXaWR0aCIsIk1hdGgiLCJtaW4iLCJhZGp1c3RlZEhlaWdodCIsImFkanVzdGVkTGVmdCIsIm1heCIsImFkanVzdGVkVG9wIiwibGVmdFBlcmNlbnRhZ2UiLCJ0b3BQZXJjZW50YWdlIiwicmVzaXplZEJ1ZmZlciIsImpwZWciLCJyZXNpemUiLCJ0b0J1ZmZlciIsImV4dHJhY3RlZEJ1ZmZlciIsImV4dHJhY3QiLCJmbG9vciIsImJhc2U2NFN0cmluZyIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInBhcnRJbmRleCIsInBhcnRCYXNlNjRTdHJpbmciLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJwYXJ0RmlsZU5hbWUiLCJ3cml0ZUZpbGVTeW5jIiwiY29udmVydEFuZFNhdmVUb0RCIiwiZXJyb3IiLCJFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkQ6XFxQSEFNSFVOR1xcY29kZS1kZW1vXFxjb3ZlckltYWdlXFxjb250cm9sbGVyc1xcIiwic291cmNlcyI6WyJpbWFnZUNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xyXG5jb25zdCBzaGFycCA9IHJlcXVpcmUoJ3NoYXJwJyk7XHJcbmNvbnN0IGRiID0gcmVxdWlyZSgnLi4vZGIvZGInKTtcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGltYWdlVG9UZXh0KGlucHV0SW1hZ2VQYXRoLCBvdXRwdXRGb2xkZXIsIGN1c3RvbUZpbGVOYW1lKSB7XHJcbiAgICAvLyAuLi4gKHBo4bqnbiBjb2RlIGNodXnhu4NuIMSR4buVaSB04burIHRyxrDhu5tjKVxyXG4gICAgLy8gS8OtY2ggdGjGsOG7m2MgY+G7p2EgdOG7q25nIHBo4bqnbiBuaOG7j1xyXG4gICAgLy8gY29uc3QgcGFydFdpZHRoID0gNDgxNjtcclxuICAgIC8vIGNvbnN0IHBhcnRIZWlnaHQgPSAzMDcyO1xyXG4gICAgLy8gY29uc3QgcGFydFdpZHRoID0gMjYwMDtcclxuICAgIC8vIGNvbnN0IHBhcnRIZWlnaHQgPSAzMTg0O1xyXG4gICAgLy8gY29uc3QgcGFydFdpZHRoID0gNTc2MDtcclxuICAgIC8vIGNvbnN0IHBhcnRIZWlnaHQgPSAzMzM2O1xyXG4gICAgLy8gY29uc3QgcGFydFdpZHRoID0gNDI0MjtcclxuICAgIC8vIGNvbnN0IHBhcnRIZWlnaHQgPSAyNDU2O1xyXG4gICAgLy8gY29uc3QgcGFydFdpZHRoID0gNTM3MjtcclxuICAgIC8vIGNvbnN0IHBhcnRIZWlnaHQgPSAyODI0O1xyXG4gICAgY29uc3QgcGFydFdpZHRoID0gODE5MjtcclxuICAgIGNvbnN0IHBhcnRIZWlnaHQgPSA0MDk2O1xyXG4gICAgLy8gWm9vbSBmYWN0b3JcclxuICAgIGNvbnN0IHpvb20gPSAxLjA7XHJcbiAgICAvLyDEkOG7jWMg4bqjbmggdsOgIGNodXnhu4NuIMSR4buVaSB0aMOgbmggY8OhYyBwaOG6p24gbmjhu49cclxuICAgIGNvbnN0IGltYWdlQnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKGlucHV0SW1hZ2VQYXRoKTtcclxuICAgIGNvbnN0IGltYWdlID0gc2hhcnAoaW1hZ2VCdWZmZXIpO1xyXG5cclxuICAgIC8vIFThuqFvIHRoxrAgbeG7pWMgxJHhuqd1IHJhIG7hur91IGNoxrBhIHThu5NuIHThuqFpXHJcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMob3V0cHV0Rm9sZGVyKSkge1xyXG4gICAgICAgIGZzLm1rZGlyU3luYyhvdXRwdXRGb2xkZXIpO1xyXG4gICAgfVxyXG4gICAgLy8gQ2h1eeG7g24gxJHhu5VpIHbDoCBnaGkgdsOgbyBjw6FjIGZpbGUgdsSDbiBi4bqjblxyXG4gICAgY29uc3QgaW1hZ2VNZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XHJcbiAgICBjb25zb2xlLmxvZygnSW1hZ2UgTWV0YWRhdGE6JywgaW1hZ2VNZXRhZGF0YSk7XHJcblxyXG4gICAgY29uc3QgcmVzaXplZFdpZHRoID0gaW1hZ2VNZXRhZGF0YS53aWR0aCAqIHpvb207XHJcbiAgICBjb25zdCByZXNpemVkSGVpZ2h0ID0gaW1hZ2VNZXRhZGF0YS5oZWlnaHQgKiB6b29tO1xyXG5cclxuICAgIGZvciAobGV0IHRvcCA9IDA7IHRvcCA8IGltYWdlTWV0YWRhdGEuaGVpZ2h0OyB0b3AgKz0gcGFydEhlaWdodCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdWw6BvIHbDsm5nIGzhurdwIHRvcCcpO1xyXG4gICAgICAgIGZvciAobGV0IGxlZnQgPSAwOyBsZWZ0IDwgaW1hZ2VNZXRhZGF0YS53aWR0aDsgbGVmdCArPSBwYXJ0V2lkdGgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1bDoG8gdsOybmcgbOG6t3AgbGVmdCcpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYWRqdXN0ZWRXaWR0aCA9IE1hdGgubWluKHBhcnRXaWR0aCwgaW1hZ2VNZXRhZGF0YS53aWR0aCAtIGxlZnQpO1xyXG4gICAgICAgICAgICBjb25zdCBhZGp1c3RlZEhlaWdodCA9IE1hdGgubWluKHBhcnRIZWlnaHQsIGltYWdlTWV0YWRhdGEuaGVpZ2h0IC0gdG9wKTtcclxuICAgICAgICAgICAgY29uc3QgYWRqdXN0ZWRMZWZ0ID0gTWF0aC5tYXgoMCwgbGVmdCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGFkanVzdGVkVG9wID0gTWF0aC5tYXgoMCwgdG9wKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGxlZnRQZXJjZW50YWdlID0gYWRqdXN0ZWRMZWZ0IC8gaW1hZ2VNZXRhZGF0YS53aWR0aDtcclxuICAgICAgICAgICAgY29uc3QgdG9wUGVyY2VudGFnZSA9IGFkanVzdGVkVG9wIC8gaW1hZ2VNZXRhZGF0YS5oZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBjb25zdCByZXNpemVkQnVmZmVyID0gYXdhaXQgaW1hZ2VcclxuICAgICAgICAgICAgICAgIC5qcGVnKClcclxuICAgICAgICAgICAgICAgIC5yZXNpemUocmVzaXplZFdpZHRoLCByZXNpemVkSGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgLnRvQnVmZmVyKCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBleHRyYWN0ZWRCdWZmZXIgPSBhd2FpdCBzaGFycChyZXNpemVkQnVmZmVyKVxyXG4gICAgICAgICAgICAgICAgLmV4dHJhY3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IE1hdGguZmxvb3IobGVmdFBlcmNlbnRhZ2UgKiByZXNpemVkV2lkdGgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvcDogTWF0aC5mbG9vcih0b3BQZXJjZW50YWdlICogcmVzaXplZEhlaWdodCksXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGFkanVzdGVkV2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBhZGp1c3RlZEhlaWdodFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5yZXNpemUoYWRqdXN0ZWRXaWR0aCwgYWRqdXN0ZWRIZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAudG9CdWZmZXIoKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NFN0cmluZyA9ICdkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCcgKyBCdWZmZXIuZnJvbShleHRyYWN0ZWRCdWZmZXIpLnRvU3RyaW5nKCdiYXNlNjQnKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgcGFydEluZGV4ID0gMDsgcGFydEluZGV4IDwgMTA7IHBhcnRJbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0QmFzZTY0U3RyaW5nID0gYmFzZTY0U3RyaW5nLnN1YnN0cmluZyhcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0SW5kZXggKiAoYmFzZTY0U3RyaW5nLmxlbmd0aCAvIDEwKSxcclxuICAgICAgICAgICAgICAgICAgICAocGFydEluZGV4ICsgMSkgKiAoYmFzZTY0U3RyaW5nLmxlbmd0aCAvIDEwKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0RmlsZU5hbWUgPSBgJHtvdXRwdXRGb2xkZXJ9LyR7Y3VzdG9tRmlsZU5hbWV9X3BhcnQke3BhcnRJbmRleCArIDF9LnR4dGA7XHJcbiAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKHBhcnRGaWxlTmFtZSwgcGFydEJhc2U2NFN0cmluZyk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnxJDDoyBnaGkgZmlsZTonLCBwYXJ0RmlsZU5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coJ0ltYWdlIHRvIHRleHQgY29udmVyc2lvbiBjb21wbGV0ZWQuJyk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRBbmRTYXZlVG9EQihpbnB1dEltYWdlUGF0aCwgb3V0cHV0Rm9sZGVyLCBjdXN0b21GaWxlTmFtZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBpbWFnZVRvVGV4dChpbnB1dEltYWdlUGF0aCwgb3V0cHV0Rm9sZGVyLCBjdXN0b21GaWxlTmFtZSk7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMob3V0cHV0Rm9sZGVyKTtcclxuXHJcbiAgICAgICAgLy8gZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoYCR7b3V0cHV0Rm9sZGVyfS8ke2ZpbGV9YCwgJ2Jhc2U2NCcpO1xyXG4gICAgICAgIC8vICAgICBhd2FpdCBkYi5xdWVyeSgnSU5TRVJUIElOVE8gaW1hZ2VzKG5hbWUsIGNvbnRlbnQpIFZBTFVFUygkMSwgJDIpJywgW2ZpbGUsIGNvbnRlbnRdKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0NvbnZlcnNpb24gYW5kIHNhdmluZyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOicsIGVycm9yKTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbnZlcnNpb24gYW5kIHNhdmluZyBmYWlsZWQnKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gYXN5bmMgZnVuY3Rpb24gdGV4dFRvSW1hZ2Uob3V0cHV0SW1hZ2VQYXRoLCBwYXJ0V2lkdGgsIHBhcnRIZWlnaHQpIHtcclxuLy8gICAgIHRyeSB7XHJcbi8vICAgICAgICAgLy8gVGjhu7FjIGhp4buHbiB0cnV5IHbhuqVuIGPGoSBz4bufIGThu68gbGnhu4d1IMSR4buDIGzhuqV5IGThu68gbGnhu4d1IHThu6sgYuG6o25nICdpbWFnZXMnXHJcbi8vICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCBuYW1lLCBjb250ZW50IEZST00gaW1hZ2VzJyk7XHJcblxyXG4vLyAgICAgICAgIGlmIChyZXN1bHQucm93cy5sZW5ndGggPT09IDApIHtcclxuLy8gICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gZGF0YSBmb3VuZCBpbiB0aGUgaW1hZ2VzIHRhYmxlLicpO1xyXG4vLyAgICAgICAgICAgICByZXR1cm47XHJcbi8vICAgICAgICAgfVxyXG5cclxuLy8gICAgICAgICAvLyBDaHV54buDbiDEkeG7lWkgdOG7q25nIGLhuqNuIGdoaSB04burIGPGoSBz4bufIGThu68gbGnhu4d1IHRow6BuaCDhuqNuaCB2w6AgbMawdSB2w6BvIG3huqNuZ1xyXG4vLyAgICAgICAgIGNvbnN0IGltYWdlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlc3VsdC5yb3dzLm1hcChhc3luYyAocm93KSA9PiB7XHJcbi8vICAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSByb3cuY29udGVudC5yZXBsYWNlKC9cXFxcL2csIFwiXCIpO1xyXG4vLyAgICAgICAgICAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShiYXNlNjREYXRhLCAnYmFzZTY0Jyk7XHJcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKGJhc2U2NERhdGEpO1xyXG4vLyAgICAgICAgICAgICByZXR1cm4gYnVmZmVyO1xyXG4vLyAgICAgICAgIH0pKTtcclxuXHJcbi8vICAgICAgICAgY29uc3QgZmlyc3RJbWFnZU1ldGFkYXRhID0gYXdhaXQgc2hhcnAoaW1hZ2VzWzBdKS5tZXRhZGF0YSgpO1xyXG5cclxuLy8gICAgICAgICAvLyBH4buZcCDhuqNuaFxyXG4vLyAgICAgICAgIGNvbnN0IG1lcmdlZEltYWdlID0gYXdhaXQgc2hhcnAoe1xyXG4vLyAgICAgICAgICAgICBjcmVhdGU6IHtcclxuLy8gICAgICAgICAgICAgICAgIHdpZHRoOiBwYXJ0V2lkdGggKiBNYXRoLmNlaWwoZmlyc3RJbWFnZU1ldGFkYXRhLndpZHRoIC8gcGFydFdpZHRoKSxcclxuLy8gICAgICAgICAgICAgICAgIGhlaWdodDogcGFydEhlaWdodCAqIE1hdGguY2VpbChmaXJzdEltYWdlTWV0YWRhdGEuaGVpZ2h0IC8gcGFydEhlaWdodCksXHJcbi8vICAgICAgICAgICAgICAgICBjaGFubmVsczogNCwgLy8gU+G7kSBrw6puaCBtw6B1ICg0IGNobyBSR0JBKVxyXG4vLyAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogeyByOiAyNTUsIGc6IDI1NSwgYjogMjU1LCBhbHBoYTogMSB9IC8vIE3DoHUgbuG7gW5cclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0pO1xyXG5cclxuLy8gICAgICAgICAvLyBT4butIGThu6VuZyBwaMawxqFuZyB0aOG7qWMgY29tcG9zaXRlIMSR4buDIGfhu5lwIOG6o25oXHJcbi8vICAgICAgICAgZm9yIChjb25zdCBpbWFnZSBvZiBpbWFnZXMpIHtcclxuLy8gICAgICAgICAgICAgbWVyZ2VkSW1hZ2UuY29tcG9zaXRlKFt7IGlucHV0OiBpbWFnZSwgbGVmdDogMCwgdG9wOiAwIH1dKTtcclxuLy8gICAgICAgICB9XHJcblxyXG4vLyAgICAgICAgIC8vIEdoaSDhuqNuaCBn4buZcCB2w6BvIGZpbGUgduG7m2kgxJHhu4tuaCBk4bqhbmcgUE5HXHJcbi8vICAgICAgICAgYXdhaXQgbWVyZ2VkSW1hZ2UudG9Gb3JtYXQoJ3BuZycpLnRvRmlsZShvdXRwdXRJbWFnZVBhdGgpO1xyXG4vLyAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IHRvIGltYWdlIGNvbnZlcnNpb24gY29tcGxldGVkLicpO1xyXG5cclxuLy8gICAgICAgICAvLyBUcuG6oyB24buBIMSRxrDhu51uZyBk4bqrbiB04bubaSB04buHcCB0aW4g4bqjbmggxJHDoyB04bqhb1xyXG4vLyAgICAgICAgIHJldHVybiBvdXRwdXRJbWFnZVBhdGg7XHJcbi8vICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4vLyAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBjb252ZXJzaW9uOicsIGVycm9yKTtcclxuLy8gICAgICAgICB0aHJvdyBlcnJvcjtcclxuLy8gICAgIH1cclxuLy8gfVxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY29udmVydEFuZFNhdmVUb0RCXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDO0FBQ3hCLE1BQU1DLEtBQUssR0FBR0QsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUM5QixNQUFNRSxFQUFFLEdBQUdGLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFOUIsZUFBZUcsV0FBV0EsQ0FBQ0MsY0FBYyxFQUFFQyxZQUFZLEVBQUVDLGNBQWMsRUFBRTtFQUNyRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQSxNQUFNQyxTQUFTLEdBQUcsSUFBSTtFQUN0QixNQUFNQyxVQUFVLEdBQUcsSUFBSTtFQUN2QjtFQUNBLE1BQU1DLElBQUksR0FBRyxHQUFHO0VBQ2hCO0VBQ0EsTUFBTUMsV0FBVyxHQUFHWCxFQUFFLENBQUNZLFlBQVksQ0FBQ1AsY0FBYyxDQUFDO0VBQ25ELE1BQU1RLEtBQUssR0FBR1gsS0FBSyxDQUFDUyxXQUFXLENBQUM7O0VBRWhDO0VBQ0EsSUFBSSxDQUFDWCxFQUFFLENBQUNjLFVBQVUsQ0FBQ1IsWUFBWSxDQUFDLEVBQUU7SUFDOUJOLEVBQUUsQ0FBQ2UsU0FBUyxDQUFDVCxZQUFZLENBQUM7RUFDOUI7RUFDQTtFQUNBLE1BQU1VLGFBQWEsR0FBRyxNQUFNSCxLQUFLLENBQUNJLFFBQVEsQ0FBQyxDQUFDO0VBQzVDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRUgsYUFBYSxDQUFDO0VBRTdDLE1BQU1JLFlBQVksR0FBR0osYUFBYSxDQUFDSyxLQUFLLEdBQUdYLElBQUk7RUFDL0MsTUFBTVksYUFBYSxHQUFHTixhQUFhLENBQUNPLE1BQU0sR0FBR2IsSUFBSTtFQUVqRCxLQUFLLElBQUljLEdBQUcsR0FBRyxDQUFDLEVBQUVBLEdBQUcsR0FBR1IsYUFBYSxDQUFDTyxNQUFNLEVBQUVDLEdBQUcsSUFBSWYsVUFBVSxFQUFFO0lBQzdEUyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUMvQixLQUFLLElBQUlNLElBQUksR0FBRyxDQUFDLEVBQUVBLElBQUksR0FBR1QsYUFBYSxDQUFDSyxLQUFLLEVBQUVJLElBQUksSUFBSWpCLFNBQVMsRUFBRTtNQUM5RFUsT0FBTyxDQUFDQyxHQUFHLENBQUMsbUJBQW1CLENBQUM7TUFFaEMsTUFBTU8sYUFBYSxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQ3BCLFNBQVMsRUFBRVEsYUFBYSxDQUFDSyxLQUFLLEdBQUdJLElBQUksQ0FBQztNQUNyRSxNQUFNSSxjQUFjLEdBQUdGLElBQUksQ0FBQ0MsR0FBRyxDQUFDbkIsVUFBVSxFQUFFTyxhQUFhLENBQUNPLE1BQU0sR0FBR0MsR0FBRyxDQUFDO01BQ3ZFLE1BQU1NLFlBQVksR0FBR0gsSUFBSSxDQUFDSSxHQUFHLENBQUMsQ0FBQyxFQUFFTixJQUFJLENBQUM7TUFDdEMsTUFBTU8sV0FBVyxHQUFHTCxJQUFJLENBQUNJLEdBQUcsQ0FBQyxDQUFDLEVBQUVQLEdBQUcsQ0FBQztNQUVwQyxNQUFNUyxjQUFjLEdBQUdILFlBQVksR0FBR2QsYUFBYSxDQUFDSyxLQUFLO01BQ3pELE1BQU1hLGFBQWEsR0FBR0YsV0FBVyxHQUFHaEIsYUFBYSxDQUFDTyxNQUFNO01BRXhELE1BQU1ZLGFBQWEsR0FBRyxNQUFNdEIsS0FBSyxDQUM1QnVCLElBQUksQ0FBQyxDQUFDLENBQ05DLE1BQU0sQ0FBQ2pCLFlBQVksRUFBRUUsYUFBYSxDQUFDLENBQ25DZ0IsUUFBUSxDQUFDLENBQUM7TUFFZixNQUFNQyxlQUFlLEdBQUcsTUFBTXJDLEtBQUssQ0FBQ2lDLGFBQWEsQ0FBQyxDQUM3Q0ssT0FBTyxDQUFDO1FBQ0xmLElBQUksRUFBRUUsSUFBSSxDQUFDYyxLQUFLLENBQUNSLGNBQWMsR0FBR2IsWUFBWSxDQUFDO1FBQy9DSSxHQUFHLEVBQUVHLElBQUksQ0FBQ2MsS0FBSyxDQUFDUCxhQUFhLEdBQUdaLGFBQWEsQ0FBQztRQUM5Q0QsS0FBSyxFQUFFSyxhQUFhO1FBQ3BCSCxNQUFNLEVBQUVNO01BQ1osQ0FBQyxDQUFDLENBQ0RRLE1BQU0sQ0FBQ1gsYUFBYSxFQUFFRyxjQUFjLENBQUMsQ0FDckNTLFFBQVEsQ0FBQyxDQUFDO01BRWYsTUFBTUksWUFBWSxHQUFHLHlCQUF5QixHQUFHQyxNQUFNLENBQUNDLElBQUksQ0FBQ0wsZUFBZSxDQUFDLENBQUNNLFFBQVEsQ0FBQyxRQUFRLENBQUM7TUFDaEcsS0FBSyxJQUFJQyxTQUFTLEdBQUcsQ0FBQyxFQUFFQSxTQUFTLEdBQUcsRUFBRSxFQUFFQSxTQUFTLEVBQUUsRUFBRTtRQUNqRCxNQUFNQyxnQkFBZ0IsR0FBR0wsWUFBWSxDQUFDTSxTQUFTLENBQzNDRixTQUFTLElBQUlKLFlBQVksQ0FBQ08sTUFBTSxHQUFHLEVBQUUsQ0FBQyxFQUN0QyxDQUFDSCxTQUFTLEdBQUcsQ0FBQyxLQUFLSixZQUFZLENBQUNPLE1BQU0sR0FBRyxFQUFFLENBQy9DLENBQUM7UUFFRCxNQUFNQyxZQUFZLEdBQUksR0FBRTVDLFlBQWEsSUFBR0MsY0FBZSxRQUFPdUMsU0FBUyxHQUFHLENBQUUsTUFBSztRQUNqRjlDLEVBQUUsQ0FBQ21ELGFBQWEsQ0FBQ0QsWUFBWSxFQUFFSCxnQkFBZ0IsQ0FBQztRQUNoRDdCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGNBQWMsRUFBRStCLFlBQVksQ0FBQztNQUM3QztJQUNKO0VBQ0o7RUFDQWhDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHFDQUFxQyxDQUFDO0FBQ3REO0FBRUEsZUFBZWlDLGtCQUFrQkEsQ0FBQy9DLGNBQWMsRUFBRUMsWUFBWSxFQUFFQyxjQUFjLEVBQUU7RUFDNUUsSUFBSTtJQUNBLE1BQU1ILFdBQVcsQ0FBQ0MsY0FBYyxFQUFFQyxZQUFZLEVBQUVDLGNBQWMsQ0FBQzs7SUFFL0Q7O0lBRUE7SUFDQTtJQUNBO0lBQ0E7SUFDQVcsT0FBTyxDQUFDQyxHQUFHLENBQUMsOENBQThDLENBQUM7RUFDL0QsQ0FBQyxDQUFDLE9BQU9rQyxLQUFLLEVBQUU7SUFDWm5DLE9BQU8sQ0FBQ21DLEtBQUssQ0FBQyxRQUFRLEVBQUVBLEtBQUssQ0FBQztJQUM5QixNQUFNLElBQUlDLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQztFQUNuRDtBQUNKOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0FDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2JKO0FBQ0osQ0FBQyJ9","map":{"version":3,"names":["fs","require","sharp","db","imageToText","inputImagePath","outputFolder","customFileName","partWidth","partHeight","zoom","imageBuffer","readFileSync","image","existsSync","mkdirSync","imageMetadata","metadata","console","log","resizedWidth","width","resizedHeight","height","top","left","adjustedWidth","Math","min","adjustedHeight","adjustedLeft","max","adjustedTop","leftPercentage","topPercentage","resizedBuffer","jpeg","resize","toBuffer","extractedBuffer","extract","floor","base64String","Buffer","from","toString","partIndex","partBase64String","substring","length","partFileName","writeFileSync","convertAndSaveToDB","error","Error","module","exports"],"sourceRoot":"D:\\PHAMHUNG\\code-demo\\coverImage\\controllers\\","sources":["imageController.js"],"sourcesContent":["const fs = require('fs');\r\nconst sharp = require('sharp');\r\nconst db = require('../db/db');\r\n\r\nasync function imageToText(inputImagePath, outputFolder, customFileName) {\r\n    // ... (phần code chuyển đổi từ trước)\r\n    // Kích thước của từng phần nhỏ\r\n    // const partWidth = 4816;\r\n    // const partHeight = 3072;\r\n    // const partWidth = 2600;\r\n    // const partHeight = 3184;\r\n    // const partWidth = 5760;\r\n    // const partHeight = 3336;\r\n    // const partWidth = 4242;\r\n    // const partHeight = 2456;\r\n    // const partWidth = 5372;\r\n    // const partHeight = 2824;\r\n    const partWidth = 8192;\r\n    const partHeight = 4096;\r\n    // Zoom factor\r\n    const zoom = 1.0;\r\n    // Đọc ảnh và chuyển đổi thành các phần nhỏ\r\n    const imageBuffer = fs.readFileSync(inputImagePath);\r\n    const image = sharp(imageBuffer);\r\n\r\n    // Tạo thư mục đầu ra nếu chưa tồn tại\r\n    if (!fs.existsSync(outputFolder)) {\r\n        fs.mkdirSync(outputFolder);\r\n    }\r\n    // Chuyển đổi và ghi vào các file văn bản\r\n    const imageMetadata = await image.metadata();\r\n    console.log('Image Metadata:', imageMetadata);\r\n\r\n    const resizedWidth = imageMetadata.width * zoom;\r\n    const resizedHeight = imageMetadata.height * zoom;\r\n\r\n    for (let top = 0; top < imageMetadata.height; top += partHeight) {\r\n        console.log('Vào vòng lặp top');\r\n        for (let left = 0; left < imageMetadata.width; left += partWidth) {\r\n            console.log('Vào vòng lặp left');\r\n\r\n            const adjustedWidth = Math.min(partWidth, imageMetadata.width - left);\r\n            const adjustedHeight = Math.min(partHeight, imageMetadata.height - top);\r\n            const adjustedLeft = Math.max(0, left);\r\n            const adjustedTop = Math.max(0, top);\r\n\r\n            const leftPercentage = adjustedLeft / imageMetadata.width;\r\n            const topPercentage = adjustedTop / imageMetadata.height;\r\n\r\n            const resizedBuffer = await image\r\n                .jpeg()\r\n                .resize(resizedWidth, resizedHeight)\r\n                .toBuffer();\r\n\r\n            const extractedBuffer = await sharp(resizedBuffer)\r\n                .extract({\r\n                    left: Math.floor(leftPercentage * resizedWidth),\r\n                    top: Math.floor(topPercentage * resizedHeight),\r\n                    width: adjustedWidth,\r\n                    height: adjustedHeight\r\n                })\r\n                .resize(adjustedWidth, adjustedHeight)\r\n                .toBuffer();\r\n\r\n            const base64String = 'data:image/jpeg;base64,' + Buffer.from(extractedBuffer).toString('base64');\r\n            for (let partIndex = 0; partIndex < 10; partIndex++) {\r\n                const partBase64String = base64String.substring(\r\n                    partIndex * (base64String.length / 10),\r\n                    (partIndex + 1) * (base64String.length / 10)\r\n                );\r\n            \r\n                const partFileName = `${outputFolder}/${customFileName}_part${partIndex + 1}.txt`;\r\n                fs.writeFileSync(partFileName, partBase64String);\r\n                console.log('Đã ghi file:', partFileName);\r\n            }\r\n        }\r\n    }\r\n    console.log('Image to text conversion completed.');\r\n}\r\n\r\nasync function convertAndSaveToDB(inputImagePath, outputFolder, customFileName) {\r\n    try {\r\n        await imageToText(inputImagePath, outputFolder, customFileName);\r\n\r\n        // const files = fs.readdirSync(outputFolder);\r\n\r\n        // for (const file of files) {\r\n        //     const content = fs.readFileSync(`${outputFolder}/${file}`, 'base64');\r\n        //     await db.query('INSERT INTO images(name, content) VALUES($1, $2)', [file, content]);\r\n        // }\r\n        console.log('Conversion and saving completed successfully');\r\n    } catch (error) {\r\n        console.error('Error:', error);\r\n        throw new Error('Conversion and saving failed');\r\n    }\r\n}\r\n\r\n// async function textToImage(outputImagePath, partWidth, partHeight) {\r\n//     try {\r\n//         // Thực hiện truy vấn cơ sở dữ liệu để lấy dữ liệu từ bảng 'images'\r\n//         const result = await db.query('SELECT name, content FROM images');\r\n\r\n//         if (result.rows.length === 0) {\r\n//             console.error('No data found in the images table.');\r\n//             return;\r\n//         }\r\n\r\n//         // Chuyển đổi từng bản ghi từ cơ sở dữ liệu thành ảnh và lưu vào mảng\r\n//         const images = await Promise.all(result.rows.map(async (row) => {\r\n//             const base64Data = row.content.replace(/\\\\/g, \"\");\r\n//             const buffer = Buffer.from(base64Data, 'base64');\r\n//             console.log(base64Data);\r\n//             return buffer;\r\n//         }));\r\n\r\n//         const firstImageMetadata = await sharp(images[0]).metadata();\r\n\r\n//         // Gộp ảnh\r\n//         const mergedImage = await sharp({\r\n//             create: {\r\n//                 width: partWidth * Math.ceil(firstImageMetadata.width / partWidth),\r\n//                 height: partHeight * Math.ceil(firstImageMetadata.height / partHeight),\r\n//                 channels: 4, // Số kênh màu (4 cho RGBA)\r\n//                 background: { r: 255, g: 255, b: 255, alpha: 1 } // Màu nền\r\n//             }\r\n//         });\r\n\r\n//         // Sử dụng phương thức composite để gộp ảnh\r\n//         for (const image of images) {\r\n//             mergedImage.composite([{ input: image, left: 0, top: 0 }]);\r\n//         }\r\n\r\n//         // Ghi ảnh gộp vào file với định dạng PNG\r\n//         await mergedImage.toFormat('png').toFile(outputImagePath);\r\n//         console.log('Text to image conversion completed.');\r\n\r\n//         // Trả về đường dẫn tới tệp tin ảnh đã tạo\r\n//         return outputImagePath;\r\n//     } catch (error) {\r\n//         console.error('Error during conversion:', error);\r\n//         throw error;\r\n//     }\r\n// }\r\n\r\n\r\nmodule.exports = {\r\n    convertAndSaveToDB\r\n};\r\n"],"mappings":"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"}},"mtime":1705396922312}}